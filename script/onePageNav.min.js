class onePageNav{defaultLinkActive;defaultActiveAnchor;differentActiveAnchor;classOnAnchorTag;changeOffset;parentsObtainingActiveClass;setClassesOnSections;exactMatch;allowedPaths;debugLine;navigationActiveClass;articleActiveClass;previousArticle;currentArticle;linksInNav=[];articles=[];debugLines=[];listeners=[];onChange=[];constructor({selector:a="nav a",defaultLinkActive:b=!0,classOnAnchorTag:c=!0,changeOffset:d=50,parentsObtainingActiveClass:e=[],setClassesOnSections:f=!1,debugLine:g=!1,exactMatch:h=!1,allowedPaths:i=void 0,navigationActiveClass:j="active",articleActiveClass:k="active",onChange:l=[],differentActiveAnchor:m=void 0}={}){return this.linksInNav=[...document.querySelectorAll(a)],this.linksInNav.length?void(this.defaultLinkActive=b,this.classOnAnchorTag=c,this.changeOffset=d,this.parentsObtainingActiveClass=e,this.setClassesOnSections=f,this.debugLine=g,this.exactMatch=h,this.allowedPaths=i,this.navigationActiveClass=j,this.articleActiveClass=k,this.differentActiveAnchor=m,this.onChange=l,this.invoke()):void console.error("No possible selectors were found. - `"+this.selector+"`")}set=(a,b)=>{this[a]=b,this.newlyInitialized=!0,this.invoke()};invoke=()=>{if(!this.allowedPaths||this.allowedPaths.includes(document.location.pathname))return this.handleDefaultLinkActive(),this.articles=this.findRelatedArticles(),this.articles.length?void(this.handleDebugLine(),this.handleScrollListener(),this.handleOutput()):void console.warn("No sections found")};findRelatedArticles=()=>{let a=this.linksInNav.map(a=>a.hash).filter(a=>a);return[...document.querySelectorAll(a.join(", "))]};handleScrollListener=()=>{this.listeners.forEach(a=>{removeEventListener(scroll,a)});let a=window.addEventListener("scroll",()=>this.handleOutput());this.listeners.push(a)};handleOutput=()=>{if(this.findCurrentArticle(),this.articleChanged()||this.newlyInitialized){if(this.newlyInitialized=!1,this.clearClasses(),this.handleDefaultLinkActive(),this.handleCallbacks(),null==this.currentArticle)return;this.handleArticleClasses(),this.addActiveClassesOnNavigationLinks()}};findCurrentArticle(){this.previousArticle=this.currentArticle;let a=this.articles.filter(a=>a.offsetTop<window.scrollY+window.innerHeight/(100/this.changeOffset)).at(-1);this.currentArticle=this.exactMatch?a?a.offsetHeight+a.offsetTop>window.scrollY+window.innerHeight/(100/this.changeOffset)?a:this.handleDefaultLinkActive():void 0:a}clearClasses(){this.linksInNav.forEach(a=>{this.removeActiveClass(a)}),this.articles.forEach(a=>{a.classList.remove(this.articleActiveClass)})}handleDefaultLinkActive(){this.differentActiveAnchor&&(this.defaultActiveAnchor=document.querySelector(this.differentActiveAnchor)),this.currentArticle==null&&this.defaultLinkActive&&this.addActiveClass(this.defaultActiveAnchor??this.linksInNav[0])}handleCallbacks(){this.onChange.forEach(a=>{a(this.currentArticle,this.previousArticle)})}handleArticleClasses(){this.setClassesOnSections&&this.currentArticle.classList.add(this.articleActiveClass)}addActiveClassesOnNavigationLinks(){let a=this.findLinksWithHashEqualToCurrentArticleId(this.linksInNav,this.currentArticle.id);a.forEach(a=>this.addActiveClass(a))}findLinksWithHashEqualToCurrentArticleId=(a,b)=>a.filter(a=>a.hash.includes(b));addActiveClass=a=>{this.classOnAnchorTag&&a.classList.add(this.navigationActiveClass),this.parentsObtainingActiveClass.forEach(b=>{a.closest(b).classList.add(this.navigationActiveClass)})};removeActiveClass=a=>{this.classOnAnchorTag&&a.classList.remove(this.navigationActiveClass),this.parentsObtainingActiveClass.forEach(b=>{a.closest(b).classList.remove(this.navigationActiveClass)})};articleChanged(){return this.currentArticle!=this.previousArticle}handleDebugLine=()=>{this.debugLines.forEach(a=>a.remove()),this.debugLine&&this.createDebugLine()};createDebugLine=()=>{let a=document.createElement("div");a.setAttribute("style",`position: fixed;width: 100%;background: red;height: 2px;top: calc(${this.changeOffset}% - 1px);`),this.debugLines.push(a),document.body.appendChild(a)}}