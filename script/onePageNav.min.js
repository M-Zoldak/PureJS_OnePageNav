"use strict";function _typeof(obj){"@babel/helpers - typeof";return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj;}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj;},_typeof(obj);}function _toConsumableArray(arr){return _arrayWithoutHoles(arr)||_iterableToArray(arr)||_unsupportedIterableToArray(arr)||_nonIterableSpread();}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.");}function _unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o==="string")return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _arrayLikeToArray(o,minLen);}function _iterableToArray(iter){if(typeof Symbol!=="undefined"&&iter[Symbol.iterator]!=null||iter["@@iterator"]!=null)return Array.from(iter);}function _arrayWithoutHoles(arr){if(Array.isArray(arr))return _arrayLikeToArray(arr);}function _arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2;}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,_toPropertyKey(descriptor.key),descriptor);}}function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);Object.defineProperty(Constructor,"prototype",{writable:false});return Constructor;}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function");}}function _defineProperty(obj,key,value){key=_toPropertyKey(key);if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true});}else{obj[key]=value;}return obj;}function _toPropertyKey(arg){var key=_toPrimitive(arg,"string");return _typeof(key)==="symbol"?key:String(key);}function _toPrimitive(input,hint){if(_typeof(input)!=="object"||input===null)return input;var prim=input[Symbol.toPrimitive];if(prim!==undefined){var res=prim.call(input,hint||"default");if(_typeof(res)!=="object")return res;throw new TypeError("@@toPrimitive must return a primitive value.");}return(hint==="string"?String:Number)(input);}/**
 * @options
 * @param {string} navLinksSelector - selector targeting anchor tags
 * @param {string} anchorActiveClass - class name that will be added on anchor when section reached and alternatively on parents passes inside parentsObtainingActiveClass
 * @param {string} sectionActiveClass - class name that will be added on section when reached
 * @param {string} defaultActiveElement - selector to element(e.g. `<a>` tag), which obtain class active, if none section was reached (or active if exact match option is used)
 * @param {int} changeOffset - the distance from the top of the page that the next element must be scrolled to in order to be activated. Value given in precents (0-100)% - default (50)
 * @param {boolean} updateATagClass - determines if class should be added to `<a>` tag
 * @param {boolean} defaultLinkActive - indicates whether first link element should be set as active. May be combined with exactMatch option and/or defaultActiveElement, to set another element instead of first link in array
 * @param {boolean} setClassesOnSections - if true, reached section becomes active class
 * @param {boolean} exactMatch - set class only if offset is located between begin and end of section, else change to undefined
 * @param {boolean} updateHash - update hash accordingly to section
 * @param {boolean} saveHashBetweenSections - hash won't change if there's a gap between sections - has only impact if exactMatch option is active
 * @param {array} parentsObtainingActiveClass - array of selectors for closest parent elements, where class 'active' should be added or removed when section changes
 * @param {array} allowedPaths - list of paths, where script will be evaluated e.g `['^/start/$']` for `example.com/start/`.
 * @param {array} onInit - array with functions, that should be fired after script was fully initialized e.g. `onInit: [function1, function2]`, callback receives whole onePageNav object.
 * @param {array} onChange - array with functions, that should be fired on change e.g. `onChange: [function1, function2]`, callback receives whole onePageNav object.
 * @param {boolean} debugLine - show debug line
 *
 * @link More about script can be found at https://github.com/Matheoz-sys/PureJS_onePageNav/wiki/About
 *
 * @copyright Copyright (c) 2023 Mateusz Żołdak
 * @license licensed under MIT license
 */var onePageNav=/*#__PURE__*/_createClass(// prettier-ignore
function onePageNav(){var _this=this;var _ref=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{},_ref$navLinksSelector=_ref.navLinksSelector,navLinksSelector=_ref$navLinksSelector===void 0?"nav a":_ref$navLinksSelector,_ref$defaultLinkActiv=_ref.defaultLinkActive,defaultLinkActive=_ref$defaultLinkActiv===void 0?true:_ref$defaultLinkActiv,_ref$updateATagClass=_ref.updateATagClass,updateATagClass=_ref$updateATagClass===void 0?true:_ref$updateATagClass,_ref$changeOffset=_ref.changeOffset,changeOffset=_ref$changeOffset===void 0?50:_ref$changeOffset,_ref$parentsObtaining=_ref.parentsObtainingActiveClass,parentsObtainingActiveClass=_ref$parentsObtaining===void 0?[]:_ref$parentsObtaining,_ref$setClassesOnSect=_ref.setClassesOnSections,setClassesOnSections=_ref$setClassesOnSect===void 0?false:_ref$setClassesOnSect,_ref$exactMatch=_ref.exactMatch,exactMatch=_ref$exactMatch===void 0?false:_ref$exactMatch,_ref$allowedPaths=_ref.allowedPaths,allowedPaths=_ref$allowedPaths===void 0?undefined:_ref$allowedPaths,_ref$anchorActiveClas=_ref.anchorActiveClass,anchorActiveClass=_ref$anchorActiveClas===void 0?"active":_ref$anchorActiveClas,_ref$sectionActiveCla=_ref.sectionActiveClass,sectionActiveClass=_ref$sectionActiveCla===void 0?"active":_ref$sectionActiveCla,_ref$defaultActiveEle=_ref.defaultActiveElement,defaultActiveElement=_ref$defaultActiveEle===void 0?undefined:_ref$defaultActiveEle,_ref$updateHash=_ref.updateHash,updateHash=_ref$updateHash===void 0?false:_ref$updateHash,_ref$saveHashBetweenS=_ref.saveHashBetweenSections,saveHashBetweenSections=_ref$saveHashBetweenS===void 0?true:_ref$saveHashBetweenS,_ref$onInit=_ref.onInit,onInit=_ref$onInit===void 0?[]:_ref$onInit,_ref$onChange=_ref.onChange,onChange=_ref$onChange===void 0?[]:_ref$onChange,_ref$debugLine=_ref.debugLine,debugLine=_ref$debugLine===void 0?false:_ref$debugLine;_classCallCheck(this,onePageNav);/**
     * @description use to change script behavior and initialize with new values
     * @param {string} option
     * @param {string} value
     */_defineProperty(this,"set",function(option,value){_this[option]=value;_this.refresh();});/**
     * @description initializes values once again
     */_defineProperty(this,"refresh",function(){_this.newlyInitialized=true;_this.initialize();});_defineProperty(this,"initialize",function(){if(_this.shouldTerminate())return;_this.findLinks();if(!_this.navLinks){console.debug("The selector did not match any elements - `"+_this.navLinksSelector+"`");return;}_this.findRelatedSections();if(!_this.sections){console.debug("No sections found");// return;
}_this.findElementDefaultActive();_this.handleDebugLine();_this.handleScrollListener();_this.handleOutput();_this.handleOnInitCallbacks();});_defineProperty(this,"shouldTerminate",function(){return _this.isInAllowedPaths();});_defineProperty(this,"isInAllowedPaths",function(){if(!_this.allowedPaths)return false;var currentPath=document.location.pathname.trim();var pathMatchesAllowedPaths=_this.allowedPaths.some(function(el){return currentPath.match(el.trim());});return!pathMatchesAllowedPaths;});_defineProperty(this,"findLinks",function(){_this.navLinks=_toConsumableArray(document.querySelectorAll(_this.navLinksSelector));});_defineProperty(this,"findRelatedSections",function(){var hashes=_this.navLinks.map(function(el){return el.hash;}).filter(function(el){return el;});_this.sections=_toConsumableArray(document.querySelectorAll(hashes.join(", ")));});_defineProperty(this,"handleScrollListener",function(){window.removeEventListener(scroll,_this.handleOutput);window.addEventListener("scroll",_this.handleOutput);});_defineProperty(this,"handleOutput",function(){_this.updateCurrentSection(_this.findCurrentSection());if(Section.hasChanged(_this)||_this.newlyInitialized){_this.newlyInitialized=false;_this.clearClasses();_this.handleDefaultLinkActive();_this.handleHash();if(!Section.noneActive(_this))_this.handleOnChangeCallbacks();if(Section.noneActive(_this))return;_this.handleSectionClasses();_this.addActiveClassesOnNavigationLinks();_this.handleOnChangeCallbacks();}});_defineProperty(this,"firstSectionAbove",function(){return _this.sections.filter(function(section){return Offset.belowSectionOffsetTop(_this,section);}).at(-1);});_defineProperty(this,"findCurrentSection",function(){if(_this.exactMatch)return _this.sections.filter(function(section){return Offset.exactlyInsideSection(_this,section);}).at(-1);else return _this.firstSectionAbove();});_defineProperty(this,"updateCurrentSection",function(newSection){_this.previousSection=_this.currentSection;_this.currentSection=newSection!==null&&newSection!==void 0?newSection:_this.handleDefaultLinkActive();});_defineProperty(this,"clearClasses",function(){_this.navLinks.forEach(function(link){_this.removeActiveClass(link);});_this.sections.forEach(function(el){el.classList.remove(_this.sectionActiveClass);});});_defineProperty(this,"handleDefaultLinkActive",function(){if(Section.noneActive(_this)&&_this.defaultLinkActive){var _this$elementDefaultA;_this.addActiveClass((_this$elementDefaultA=_this.elementDefaultActive)!==null&&_this$elementDefaultA!==void 0?_this$elementDefaultA:_this.navLinks[0]);}});_defineProperty(this,"handleHash",function(){if(!_this.updateHash)return;if(_this.exactMatch&&Section.noneActive(_this)&&_this.saveHashBetweenSections&&Offset.passedBeginningOfFirstArticle(_this)){var lastSectionAbove=_this.firstSectionAbove();history.replaceState(null,null,lastSectionAbove?"#"+lastSectionAbove.id:" ");}else{history.replaceState(null,null,_this.currentSection?"#"+_this.currentSection.id:" ");}});_defineProperty(this,"handleSectionClasses",function(){if(_this.setClassesOnSections){_this.currentSection.classList.add(_this.sectionActiveClass);}});_defineProperty(this,"addActiveClassesOnNavigationLinks",function(){var currentlyActiveLinks=_this.allLinksIncludingHash(_this.navLinks,_this.currentSection.id);currentlyActiveLinks.forEach(function(activeLink){return _this.addActiveClass(activeLink);});});_defineProperty(this,"allLinksIncludingHash",function(links,hash){return links.filter(function(link){return link.hash=="#".concat(hash);});});_defineProperty(this,"addActiveClass",function(aElement){if(_this.updateATagClass){aElement.classList.add(_this.anchorActiveClass);}_this.parentsObtainingActiveClass.forEach(function(parentSelector){aElement.closest(parentSelector).classList.add(_this.anchorActiveClass);});});_defineProperty(this,"removeActiveClass",function(aElement){if(_this.updateATagClass){aElement.classList.remove(_this.anchorActiveClass);}_this.parentsObtainingActiveClass.forEach(function(parentSelector){aElement.closest(parentSelector).classList.remove(_this.anchorActiveClass);});});_defineProperty(this,"findElementDefaultActive",function(){try{_this.elementDefaultActive=document.querySelector(_this.defaultActiveElement);}catch(_unused){_this.elementDefaultActive=undefined;console.debug("Default active element not found.");}});_defineProperty(this,"handleOnInitCallbacks",function(){_this.onChange.forEach(function(callback){callback(_this);});});_defineProperty(this,"handleOnChangeCallbacks",function(){_this.onChange.forEach(function(callback){callback(_this);});});_defineProperty(this,"handleDebugLine",function(){if(!_this.debugLine)_this.debugLine=new DebugLine(_this);_this.debugLine.update(_this.showDebugLine);});this.navLinksSelector=navLinksSelector;this.defaultLinkActive=defaultLinkActive;this.updateATagClass=updateATagClass;this.changeOffset=changeOffset;this.parentsObtainingActiveClass=parentsObtainingActiveClass;this.setClassesOnSections=setClassesOnSections;this.exactMatch=exactMatch;this.allowedPaths=allowedPaths;this.anchorActiveClass=anchorActiveClass;this.sectionActiveClass=sectionActiveClass;this.defaultActiveElement=defaultActiveElement;this.updateHash=updateHash;this.saveHashBetweenSections=saveHashBetweenSections;this.onInit=onInit;this.onChange=onChange;this.showDebugLine=debugLine;this.debugLine=undefined;this.sections=[];this.that=this;this.initialize();});var Offset=/*#__PURE__*/_createClass(function Offset(){_classCallCheck(this,Offset);});_defineProperty(Offset,"position",function(_ref3){var changeOffset=_ref3.changeOffset;return window.scrollY+window.innerHeight/(100/changeOffset);});_defineProperty(Offset,"belowSection",function(pageNavObj,section){if(!Section.exist(section))return false;return Offset.position(pageNavObj)>Offset.posYFromPageTop(section)+section.offsetHeight;});_defineProperty(Offset,"belowSectionOffsetTop",function(pageNavObj,section){if(!Section.exist(section))return false;return Offset.position(pageNavObj)>Offset.posYFromPageTop(section);});_defineProperty(Offset,"aboveSection",function(pageNavObj,section){if(!Section.exist(section))return false;return Offset.position(pageNavObj)<Offset.posYFromPageTop(section);});_defineProperty(Offset,"aboveSectionOffsetBottom",function(pageNavObj,section){if(!Section.exist(section))return false;return Offset.position(pageNavObj)<Offset.posYFromPageTop(section)+section.offsetHeight;});_defineProperty(Offset,"passedBeginningOfFirstArticle",function(pageNavObj){return Offset.position(pageNavObj)>pageNavObj.sections.at(0).getBoundingClientRect().top+document.documentElement.scrollTop;});_defineProperty(Offset,"exactlyInsideSection",function(pageNavObj,section){return Offset.belowSectionOffsetTop(pageNavObj,section)&&Offset.aboveSectionOffsetBottom(pageNavObj,section);});_defineProperty(Offset,"posYFromPageTop",function(section){return section.getBoundingClientRect().top+document.documentElement.scrollTop;});var Section=/*#__PURE__*/_createClass(function Section(){_classCallCheck(this,Section);});_defineProperty(Section,"exist",function(section){return section?true:false;});_defineProperty(Section,"hasChanged",function(_ref4){var currentSection=_ref4.currentSection,previousSection=_ref4.previousSection;return currentSection!=previousSection;});_defineProperty(Section,"noneActive",function(_ref5){var currentSection=_ref5.currentSection;return currentSection==undefined;});var DebugLine=/*#__PURE__*/function(){function DebugLine(_ref2){var _this2=this;var changeOffset=_ref2.changeOffset;_classCallCheck(this,DebugLine);_defineProperty(this,"createBar",function(){_this2.debugLine=document.createElement("div");_this2.debugLine.classList.add("debugLine");_this2.debugLine.setAttribute("style","position: fixed;width: 100%;background: #ff00007a;height: 4px;transition: .6s; top:50%;");document.body.appendChild(_this2.debugLine);});_defineProperty(this,"remove",function(){if(_this2.debugLine){_this2.debugLine.remove();_this2.debugLine=undefined;}});_defineProperty(this,"updateOffset",function(){_this2.debugLine.style.top="calc(".concat(_this2.changeOffset,"% - 2px)");});this.changeOffset=changeOffset;this.update();}_createClass(DebugLine,[{key:"update",value:function update(show){if(show){this.debugLine?this.updateOffset():this.createBar();}else{this.remove();}}}]);return DebugLine;}();
